> **Status (2026-02-11): Legacy reference.** This document contains historical notes about removed hooks (`useQueryWithCache`, `useRealtimeSync`).
> Current data layer uses TanStack Query feature hooks in `src/features/*` with shared keys in `src/shared/query/queryKeys.ts`.
## рџљЂ РџСЂРѕС„РµСЃСЃРёРѕРЅР°Р»СЊРЅРѕРµ СЂРµС€РµРЅРёРµ РґР»СЏ РїР°СЂР°Р»Р»РµР»СЊРЅРѕР№ Р·Р°РіСЂСѓР·РєРё РґР°РЅРЅС‹С…

### РџСЂРѕР±Р»РµРјР°

РџСЂРё РєР°Р¶РґРѕР№ Р·Р°РіСЂСѓР·РєРµ СЃС‚СЂР°РЅРёС†С‹ `users/index.jsx` РѕС‚РґРµР»С‹ Р·Р°РіСЂСѓР¶Р°Р»РёСЃСЊ Р·Р°РЅРѕРІРѕ, С‡С‚Рѕ РІС‹Р·С‹РІР°Р»Рѕ РІРёР·СѓР°Р»СЊРЅРѕРµ РјРµСЂС†Р°РЅРёРµ СЃС‚СЂРѕРє СЃ РѕС‚РґРµР»РѕРј Рё РїСЂРёРІРѕРґРёР»Рѕ Рє Р»РёС€РЅРёРј Р·Р°РїСЂРѕСЃР°Рј Рє Р‘Р”.

### Р РµС€РµРЅРёРµ

#### 1. **РќРѕРІС‹Р№ С…СѓРє `useParallelDataLoad`**

**Р¤Р°Р№Р»:** `components/hooks/useParallelDataLoad.js`

РџРѕР·РІРѕР»СЏРµС‚ РѕРґРЅРѕРІСЂРµРјРµРЅРЅРѕ Р·Р°РіСЂСѓР¶Р°С‚СЊ РґР°РЅРЅС‹Рµ РёР· РЅРµСЃРєРѕР»СЊРєРёС… РёСЃС‚РѕС‡РЅРёРєРѕРІ:

- РРЅРёС†РёР°Р»РёР·РёСЂСѓРµС‚ РІСЃРµ С…СѓРєРё РїР°СЂР°Р»Р»РµР»СЊРЅРѕ
- РЎРёРЅС…СЂРѕРЅРёР·РёСЂСѓРµС‚ СЃРѕСЃС‚РѕСЏРЅРёРµ Р·Р°РіСЂСѓР·РєРё РґР»СЏ РІСЃРµС… РёСЃС‚РѕС‡РЅРёРєРѕРІ
- РџСЂРµРґРѕСЃС‚Р°РІР»СЏРµС‚ РµРґРёРЅСѓСЋ С„СѓРЅРєС†РёСЋ `refreshAll()` РґР»СЏ РѕР±РЅРѕРІР»РµРЅРёСЏ РІСЃРµС… РґР°РЅРЅС‹С…

```javascript
const { users, departments, isLoading, refreshAll } = useParallelDataLoad({
  users: { hook: useUsers, options: { filters } },
  departments: { hook: useDepartments, options: { companyId } },
});
```

#### 2. **Р Р°СЃС€РёСЂРµРЅРЅРѕРµ РєРµС€РёСЂРѕРІР°РЅРёРµ РѕС‚РґРµР»РѕРІ**

**Р¤Р°Р№Р»:** `components/hooks/useDepartments.js`

РР·РјРµРЅРµРЅС‹ РїР°СЂР°РјРµС‚СЂС‹ РєРµС€РёСЂРѕРІР°РЅРёСЏ:

- **TTL:** 60 РјРёРЅСѓС‚ (Р±С‹Р»Рѕ 10) вЂ” РѕС‚РґРµР»С‹ РїСЂР°РєС‚РёС‡РµСЃРєРё РЅРµ РјРµРЅСЏСЋС‚СЃСЏ
- **staleTime:** 30 РјРёРЅСѓС‚ (Р±С‹Р»Рѕ 5) вЂ” РѕР±РЅРѕРІР»СЏРµРј РІ С„РѕРЅРµ РµСЃР»Рё РґР°РЅРЅС‹Рµ СЃС‚Р°СЂС€Рµ 30 РјРёРЅСѓС‚

Р­С‚Рѕ РѕР·РЅР°С‡Р°РµС‚:

- РџРµСЂРІС‹Р№ РІРёР·РёС‚: Р·Р°РіСЂСѓР¶Р°СЋС‚СЃСЏ РѕС‚РґРµР»С‹ СЃ СЃРµСЂРІРµСЂР°
- РџРѕСЃР»РµРґСѓСЋС‰РёРµ РІРёР·РёС‚С‹ РІ С‚РµС‡РµРЅРёРµ 60 РјРёРЅСѓС‚: РґР°РЅРЅС‹Рµ Р±РµСЂСѓС‚СЃСЏ РёР· РєРµС€Р° РјРіРЅРѕРІРµРЅРЅРѕ
- Р§РµСЂРµР· 30 РјРёРЅСѓС‚: РїРѕРєР°Р·С‹РІР°РµРј РєСЌС€РёСЂРѕРІР°РЅРЅС‹Рµ РґР°РЅРЅС‹Рµ Рё РѕР±РЅРѕРІР»СЏРµРј РІ С„РѕРЅРµ (Stale-While-Revalidate)

#### 3. **РћР±РЅРѕРІР»РµРЅРЅР°СЏ Р»РѕРіРёРєР° РІ `users/index.jsx`**

```javascript
// Р‘Р«Р›Рћ (РїРѕСЃР»РµРґРѕРІР°С‚РµР»СЊРЅР°СЏ Р·Р°РіСЂСѓР·РєР°):
const { users, isLoading: usersLoading } = useUsers({...});
const { departments, isLoading: departmentsLoading } = useDepartments({...});
const isLoading = usersLoading || departmentsLoading; // Р¶РґРµРј РћР‘Рђ

// РЎРўРђР›Рћ (РїР°СЂР°Р»Р»РµР»СЊРЅР°СЏ Р·Р°РіСЂСѓР·РєР°):
const {
  users,
  departments,
  isLoading: usersLoading,
  departmentsLoading,
  isRefreshing,
  refreshAll,
} = useParallelDataLoad({
  users: { hook: useUsers, options: {...} },
  departments: { hook: useDepartments, options: {...} },
});

const isLoading = usersLoading && departmentsLoading; // РѕР±Р° РѕРґРЅРѕРІСЂРµРјРµРЅРЅРѕ
```

### рџЋЇ РџСЂРµРёРјСѓС‰РµСЃС‚РІР°

| РџР°СЂР°РјРµС‚СЂ                    | Р‘С‹Р»Рѕ            | РЎС‚Р°Р»Рѕ                    | РЈР»СѓС‡С€РµРЅРёРµ       |
| --------------------------- | --------------- | ------------------------ | --------------- |
| **РњРµСЂС†Р°РЅРёРµ РѕС‚РґРµР»РѕРІ**        | РљР°Р¶РґС‹Р№ РІРёР·РёС‚    | РўРѕР»СЊРєРѕ РїСЂРё РїРµСЂРІРѕРј РІРёР·РёС‚Рµ | вњ… РЈСЃС‚СЂР°РЅРµРЅРѕ    |
| **Р’СЂРµРјСЏ Р·Р°РіСЂСѓР·РєРё СЃС‚СЂР°РЅРёС†С‹** | РџРѕСЃР»РµРґРѕРІР°С‚РµР»СЊРЅРѕ | РџР°СЂР°Р»Р»РµР»СЊРЅРѕ              | вњ… Р‘С‹СЃС‚СЂРµРµ      |
| **Р—Р°РїСЂРѕСЃС‹ Рє Р‘Р”**            | РљР°Р¶РґС‹Р№ СЂР°Р·      | 1 СЂР°Р· РІ 60 РјРёРЅСѓС‚         | вњ… Р­РєРѕРЅРѕРјРёСЏ     |
| **РџР°С‚С‚РµСЂРЅ РєРµС€РёСЂРѕРІР°РЅРёСЏ**     | Standard TTL    | Stale-While-Revalidate   | вњ… Р›СѓС‡С€Рµ UX     |
| **РћР±РЅРѕРІР»РµРЅРёРµ РїСЂРё Realtime** | РћС‚РґРµР»СЊРЅРѕ        | РЎРёРЅС…СЂРѕРЅРёР·РёСЂРѕРІР°РЅРѕ         | вњ… РљРѕРЅСЃРёСЃС‚РµРЅС‚РЅРѕ |

### рџ“Љ РљР°Рє СЌС‚Рѕ СЂР°Р±РѕС‚Р°РµС‚

```
РџР•Р Р’Р«Р™ Р’РР—РРў:
в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ
в”‚ ParallelDataLoad РёРЅРёС†РёРёСЂСѓРµС‚:           в”‚
в”‚  вЂў useUsers() в†’ fetch РѕС‚ СЃРµСЂРІРµСЂР°       в”‚
в”‚  вЂў useDepartments() в†’ fetch РѕС‚ СЃРµСЂРІРµСЂР° в”‚
в”‚  (РїР°СЂР°Р»Р»РµР»СЊРЅРѕ, РЅРµ РїРѕСЃР»РµРґРѕРІР°С‚РµР»СЊРЅРѕ!)   в”‚
в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”
         в†“ С‡РµСЂРµР· РЅРµСЃРєРѕР»СЊРєРѕ СЃРµРє
     Р”Р°РЅРЅС‹Рµ РІ РєСЌС€Рµ (TTL: 60 РјРёРЅ)

Р’РўРћР РћР™ Р’РР—РРў (РІ С‚РµС‡РµРЅРёРµ 60 РјРёРЅСѓС‚):
в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ
в”‚ ParallelDataLoad РёРЅРёС†РёРёСЂСѓРµС‚:           в”‚
в”‚  вЂў useUsers() в†’ РёР· РљР•РЁРђ (РјРіРЅРѕРІРµРЅРЅРѕ!)   в”‚
в”‚  вЂў useDepartments() в†’ РёР· РљР•РЁРђ (!)      в”‚
в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”

РўР Р•РўРР™ Р’РР—РРў (С‡РµСЂРµР· 30 РјРёРЅ, РЅРѕ < 60 РјРёРЅ):
в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ
в”‚ РџРѕРєР°Р·С‹РІР°РµРј РљР­РЁРР РћР’РђРќРќР«Р• РґР°РЅРЅС‹Рµ         в”‚
в”‚ Р’ Р¤РћРќР•: Р·Р°РїСЂР°С€РёРІР°РµРј СЃРІРµР¶РёРµ РґР°РЅРЅС‹Рµ      в”‚
в”‚ (Stale-While-Revalidate pattern)       в”‚
в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”
```

### рџ”„ Realtime СЃРёРЅС…СЂРѕРЅРёР·Р°С†РёСЏ

РџСЂРё РёР·РјРµРЅРµРЅРёРё РѕС‚РґРµР»РѕРІ РІ Р‘Р” С‡РµСЂРµР· Realtime:

1. РћР±Р° С…СѓРєР° РїРѕР»СѓС‡Р°С‚ СѓРІРµРґРѕРјР»РµРЅРёРµ
2. РћР±Р° РѕР±РЅРѕРІСЏС‚ РґР°РЅРЅС‹Рµ РІ С„РѕРЅРµ
3. UI РѕР±РЅРѕРІРёС‚СЃСЏ Р°РІС‚РѕРјР°С‚РёС‡РµСЃРєРё С‡РµСЂРµР· `useParallelDataLoad`

### вљ™пёЏ РўРµС…РЅРёС‡РµСЃРєРёРµ РґРµС‚Р°Р»Рё

- **useQueryWithCache**: Р“Р»РѕР±Р°Р»СЊРЅС‹Р№ РєРµС€ СЃ РґРµРґСѓРїР»РёРєР°С†РёРµР№ Р·Р°РїСЂРѕСЃРѕРІ
- **useRealtimeSync**: РђРІС‚РѕРјР°С‚РёС‡РµСЃРєР°СЏ СЃРёРЅС…СЂРѕРЅРёР·Р°С†РёСЏ РїСЂРё РёР·РјРµРЅРµРЅРёСЏС… Р‘Р”
- **useParallelDataLoad**: РћСЂРєРµСЃС‚СЂР°С‚РѕСЂ РґР»СЏ РѕРґРЅРѕРІСЂРµРјРµРЅРЅРѕР№ Р·Р°РіСЂСѓР·РєРё

Р’СЃРµ РєРѕРјРїРѕРЅРµРЅС‚С‹ СЂР°Р±РѕС‚Р°СЋС‚ РІРјРµСЃС‚Рµ РґР»СЏ СЃРѕР·РґР°РЅРёСЏ РіР»Р°РґРєРѕРіРѕ, Р±С‹СЃС‚СЂРѕРіРѕ UX Р±РµР· РјРµСЂС†Р°РЅРёСЏ Рё Р»РёС€РЅРёС… Р·Р°РїСЂРѕСЃРѕРІ.
