# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ "Database error querying schema"

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –ª–æ–≥–∏–Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –æ—à–∏–±–∫–∞:
```
Auth error during login: {"errorKey":"errors_auth_error","originalMessage":"Database error querying schema","status":500,"email":"..."}
```

## –ü—Ä–∏—á–∏–Ω–∞

–í RPC —Ñ—É–Ω–∫—Ü–∏—è—Ö `invite_user` –∏ `admin_set_user_password` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –≤—ã–∑–æ–≤—ã:
- ‚ùå `extensions.crypt()` ‚Üí ‚úÖ `crypt()`
- ‚ùå `extensions.gen_salt()` ‚Üí ‚úÖ `gen_salt()`
- ‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `md5()` –¥–ª—è token ‚Üí ‚úÖ `gen_random_bytes(32)`

## –†–µ—à–µ–Ω–∏–µ

### –®–∞–≥ 1: –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

1. –û—Ç–∫—Ä–æ–π—Ç–µ [Supabase Dashboard](https://app.supabase.com)
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ `SQL Editor` (–ª–µ–≤–æ–µ –º–µ–Ω—é)
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–µ—Å—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `deploy_functions.sql`
4. –í—Å—Ç–∞–≤—å—Ç–µ –≤ –Ω–æ–≤—ã–π SQL –∑–∞–ø—Ä–æ—Å –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ
5. –ù–∞–∂–º–∏—Ç–µ `Run`

> ‚ö†Ô∏è –≠—Ç–æ –∑–∞–º–µ–Ω–∏—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å RLS –ø–æ–ª–∏—Ç–∏–∫–∏ —Ç–∞–±–ª–∏—Ü—ã `profiles`

1. –í Supabase Dashboard –æ—Ç–∫—Ä–æ–π—Ç–µ `Table Editor`
2. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É `profiles`
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ `RLS Policies` (–ø—Ä–∞–≤–æ–µ –º–µ–Ω—é)
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –µ—Å—Ç—å –ø–æ–ª–∏—Ç–∏–∫–∞ –¥–ª—è `SELECT`:
   - `authenticated users` –º–æ–≥—É—Ç —á–∏—Ç–∞—Ç—å —Å–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å
   - –ò–ª–∏ –ø–æ–ª–∏—Ç–∏–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤–∫–ª—é—á–µ–Ω–∞

### –®–∞–≥ 3: –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

1. –í Terminal (node) –Ω–∞–∂–º–∏—Ç–µ `Ctrl+C` –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ Expo
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ `npx expo start`
3. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ (–∏–ª–∏ –≤ —ç–º—É–ª—è—Ç–æ—Ä–µ)
4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ª–æ–≥–∏–Ω–∏—Ç—å—Å—è —Å–Ω–æ–≤–∞

## –ï—Å–ª–∏ –≤—Å–µ –µ—â–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Supabase:
1. –í Supabase Dashboard –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ `Logs` (–ª–µ–≤–æ–µ –º–µ–Ω—é)
2. –í—ã–±–µ—Ä–∏—Ç–µ `Database` ‚Üí `Postgres`
3. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –æ—à–∏–±–∫–∏ –≤ –ª–æ–≥–∞—Ö –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ª–æ–≥–∏–Ω–∞
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏ –≤ —Å–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å

## –ö–æ–¥ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –î–û ‚ùå
```sql
encrypted_password = extensions.crypt(p_temp_password, extensions.gen_salt('bf')),
confirmation_token = md5(random()::text || clock_timestamp()::text),
```

### –ü–û–°–õ–ï ‚úÖ
```sql
encrypted_password = crypt(p_temp_password, gen_salt('bf')),
confirmation_token = encode(gen_random_bytes(32), 'hex'),
```
