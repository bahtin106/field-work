# üìö –ò–ù–î–ï–ö–°: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ Auth –≤ Self-Hosted Supabase

## üéØ –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—É—Ç—å

### üë∂ "–Ø –ø—Ä–æ—Å—Ç–æ —Ö–æ—á—É –≤—Å—ë —Ä–∞–±–æ—Ç–∞–ª–æ" (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)
**‚Üí –û—Ç–∫—Ä–æ–π—Ç–µ:** [`VISUAL_AUTH_RECOVERY.md`](VISUAL_AUTH_RECOVERY.md)
- –ü–æ—à–∞–≥–æ–≤—ã–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã
- –¢–æ—á–Ω—ã–µ –º–µ—Å—Ç–∞ –¥–ª—è –∫–ª–∏–∫–∞
- 5 –º–∏–Ω—É—Ç –≤—Ä–µ–º–µ–Ω–∏

### üîß "–Ø —Ö–æ—á—É –ø–æ–Ω—è—Ç—å —á—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ"
**‚Üí –û—Ç–∫—Ä–æ–π—Ç–µ:** [`AUTH_RECOVERY_SUMMARY.md`](AUTH_RECOVERY_SUMMARY.md)
- –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã
- –¢–∞–±–ª–∏—Ü–∞ "–¥–æ/–ø–æ—Å–ª–µ"
- –ù–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ä–µ—à–µ–Ω–∏—è

### ‚ö° "–î–∞–π—Ç–µ –º–Ω–µ –≥–æ—Ç–æ–≤—ã–π –∫–æ–¥"
**‚Üí –û—Ç–∫—Ä–æ–π—Ç–µ:** [`QUICK_AUTH_RECOVERY.md`](QUICK_AUTH_RECOVERY.md)
- –ì–æ—Ç–æ–≤—ã–π SQL –∫–æ–¥
- –ì–æ—Ç–æ–≤—ã–π curl –∫–æ–¥
- –ì–æ—Ç–æ–≤—ã–π bash —Å–∫—Ä–∏–ø—Ç

### üìñ "–Ø —Ö–æ—á—É —É–∑–Ω–∞—Ç—å –≤—Å—ë –≤ –¥–µ—Ç–∞–ª—è—Ö"
**‚Üí –û—Ç–∫—Ä–æ–π—Ç–µ:** [`SELFHOSTED_AUTH_RECOVERY.md`](SELFHOSTED_AUTH_RECOVERY.md)
- –ü–æ–ª–Ω—ã–π —Ä–∞–∑–±–æ—Ä —Å–∏—Ç—É–∞—Ü–∏–∏
- –í—Å–µ 3 –≤–∞—Ä–∏–∞–Ω—Ç–∞ —Ä–µ—à–µ–Ω–∏—è
- –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞

---

## üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –£—Ä–æ–≤–µ–Ω—å |
|------|-----------|--------|
| **VISUAL_AUTH_RECOVERY.md** | üëà **–ù–ê–ß–ù–ò–¢–ï –û–¢–°–Æ–î–ê** | –ù–æ–≤–∏—á–æ–∫ |
| **QUICK_AUTH_RECOVERY.md** | –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ (2 –≤–∞—Ä–∏–∞–Ω—Ç–∞) | –°—Ä–µ–¥–Ω–∏–π |
| **AUTH_RECOVERY_SUMMARY.md** | –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ + —á–µ–∫-–ª–∏—Å—Ç | –°—Ä–µ–¥–Ω–∏–π |
| **SELFHOSTED_AUTH_RECOVERY.md** | –ü–æ–ª–Ω—ã–π –≥–∞–π–¥ (3 –≤–∞—Ä–∏–∞–Ω—Ç–∞) | –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π |
| **restore_user.sql** | –ì–æ—Ç–æ–≤—ã–π SQL —Å–∫—Ä–∏–ø—Ç | –†–µ–∫–≤–∏–∑–∏—Ç |
| **restore_user.sh** | Bash —Å–∫—Ä–∏–ø—Ç –¥–ª—è curl | –†–µ–∫–≤–∏–∑–∏—Ç |
| **check_supabase.sh** | –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç | –†–µ–∫–≤–∏–∑–∏—Ç |
| **supabase/functions/restore_user/index.ts** | Edge Function | –†–µ–∫–≤–∏–∑–∏—Ç |
| **hooks/useAuthLogin.js** | ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ | –£–ª—É—á—à–µ–Ω–∏–µ |
| **lib/supabase.js** | ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω debug –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ | –£–ª—É—á—à–µ–Ω–∏–µ |

---

## üöÄ –¢—Ä–µ—Ö–º–∏–Ω—É—Ç–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

```bash
# 1. –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä
https://supabase.monitorapp.ru/project/default

# 2. SQL Editor ‚Üí New Query

# 3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏–∑ QUICK_AUTH_RECOVERY.md (—Ä–∞–∑–¥–µ–ª SQL)

# 4. –ù–∞–∂–º–∏—Ç–µ Run

# 5. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–æ–π—Ç–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
```

---

## üìã –°–∞–º—ã–µ —á–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

### "–ö–∞–∫–æ–π –ø–∞—Ä–æ–ª—å –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è?"
```
–í SQL –∫–æ–¥–µ –º—ã –≤—Å—Ç–∞–≤–ª—è–µ–º —Ö–µ—à –ø–∞—Ä–æ–ª—è "Bahtin106"
–í—Ö–æ–¥: Email: Bahtin106@gmail.com, Password: Bahtin106
```

### "–ë–µ–∑–æ–ø–∞—Å–Ω–æ –ª–∏ —ç—Ç–æ?"
```
‚úÖ –ü–∞—Ä–æ–ª—å —Ö–µ—à–∏—Ä—É–µ—Ç—Å—è bcrypt –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º (crypt —Ñ—É–Ω–∫—Ü–∏—è)
‚úÖ –≠—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å–ø–æ—Å–æ–± –≤ PostgreSQL
‚úÖ –ù–∏—á–µ–º –Ω–µ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç —Å–æ–∑–¥–∞–Ω–∏—è —é–∑–µ—Ä–∞ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
```

### "–ß—Ç–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç?"
```
SQL –∫–æ–¥ –∏–º–µ–µ—Ç WHERE NOT EXISTS, –ø–æ—ç—Ç–æ–º—É –Ω–µ –±—É–¥–µ—Ç –¥—É–±–ª–µ–π
–ü—Ä–æ—Å—Ç–æ –±—É–¥–µ—Ç: "INSERT 0 0" (0 —Å—Ç—Ä–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω–æ)
–≠—Ç–æ OK, –ø—Ä–æ—Å—Ç–æ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–æ–π—Ç–∏
```

### "–ù—É–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π?"
```
–û—Ç–∫—Ä–æ–π—Ç–µ: SELFHOSTED_AUTH_RECOVERY.md ‚Üí –í–∞—Ä–∏–∞–Ω—Ç 3
–¢–∞–º –µ—Å—Ç—å —Å–ø–æ—Å–æ–± —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ—Ö –∏–∑ Cloud –∏ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å
```

### "–ß—Ç–æ –µ—Å–ª–∏ Studio –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞?"
```
–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
docker exec -i supabase-db psql -U postgres -d postgres < restore_user.sql
```

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

- [ ] **–®–∞–≥ 1:** –í—ã–±—Ä–∞–ª–∏ –≥–∞–π–¥ (–Ω–∞—á–Ω–∏—Ç–µ —Å VISUAL_AUTH_RECOVERY.md)
- [ ] **–®–∞–≥ 2:** –û—Ç–∫—Ä—ã–ª–∏ Supabase Studio
- [ ] **–®–∞–≥ 3:** –í—ã–ø–æ–ª–Ω–∏–ª–∏ SQL –∫–æ–¥
- [ ] **–®–∞–≥ 4:** –ü—Ä–æ–≤–µ—Ä–∏–ª–∏ —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–∏–ª—Å—è
- [ ] **–®–∞–≥ 5:** –ó–∞–ø—É—Å—Ç–∏–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (expo start -c)
- [ ] **–®–∞–≥ 6:** –í–æ—à–ª–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- [ ] **‚úÖ –ì–æ—Ç–æ–≤–æ!**

---

## üÜò –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –≤ SQL Editor:

```sql
-- 1. –°–∫–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π?
SELECT COUNT(*) FROM auth.users;

-- 2. –ï—Å—Ç—å –ª–∏ –Ω–∞—à –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å?
SELECT id, email FROM auth.users WHERE email = 'Bahtin106@gmail.com';

-- 3. –ö–∞–∫–∏–µ –ø—Ä–æ—Ñ–∏–ª–∏ –≤ public?
SELECT COUNT(*) FROM public.profiles;
```

### –ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç 0:
- SQL –∫–æ–¥ –Ω–µ –≤—ã–ø–æ–ª–Ω–∏–ª—Å—è
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∑–∞–Ω–æ–≤–æ –∏–∑ QUICK_AUTH_RECOVERY.md

### –ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç > 0 –Ω–æ –≤—Ö–æ–¥ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL –≤ app.json: –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `https://supabase.monitorapp.ru`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ ANON_KEY –≤ app.json: –¥–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å ~/n8n-install/.env
- –û—á–∏—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: `expo start -c` (–±–µ–∑ –∫—ç—à–∞)

---

## üìû –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?

1. **–û—Ç–∫—Ä–æ–π—Ç–µ:** [`VISUAL_AUTH_RECOVERY.md`](VISUAL_AUTH_RECOVERY.md) –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ —à–∞–≥–∏
2. **–ï—Å–ª–∏ –∑–∞—Å—Ç—Ä—è–ª–∏:** –î–∞–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã SQL –∫–æ–º–∞–Ω–¥ –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ "–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞"
3. **–ï—Å–ª–∏ –Ω—É–∂–µ–Ω –∫–æ–¥:** –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏–∑ [`QUICK_AUTH_RECOVERY.md`](QUICK_AUTH_RECOVERY.md)
4. **–ï—Å–ª–∏ –Ω—É–∂–Ω—ã –¥–µ—Ç–∞–ª–∏:** –ß–∏—Ç–∞–π—Ç–µ [`SELFHOSTED_AUTH_RECOVERY.md`](SELFHOSTED_AUTH_RECOVERY.md)

---

## üéì –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### –í –∫–æ–¥–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
1. ‚úÖ `hooks/useAuthLogin.js` - –¥–æ–±–∞–≤–ª–µ–Ω–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
2. ‚úÖ `lib/supabase.js` - –¥–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
3. ‚úÖ `.env.local` - —Å–æ–∑–¥–∞–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
4. ‚úÖ `supabase/.env.local` - —Å–æ–∑–¥–∞–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π

### –í Supabase:
1. ‚úÖ `supabase/functions/restore_user/index.ts` - –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
2. ‚úÖ `app.json` - –ø—Ä–æ–≤–µ—Ä–µ–Ω URL –∏ –∫–ª—é—á–∏
3. ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∑–∞–ø–∏—Å—å –≤ `auth.users`

---

## üèÅ –ò—Ç–æ–≥

**–ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞:** auth.users —Ç–∞–±–ª–∏—Ü–∞ –ø—É—Å—Ç–∞ –≤ self-hosted  
**–†–µ—à–µ–Ω–∏–µ:** –í—Å—Ç–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–±—Ä–∞—Ç–Ω–æ —á–µ—Ä–µ–∑ SQL  
**–í—Ä–µ–º—è:** 5 –º–∏–Ω—É—Ç  
**–†–∏—Å–∫:** –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –≤–Ω–µ–¥—Ä–µ–Ω–∏—é

**–ù–∞—á–Ω–∏—Ç–µ —Å:** [`VISUAL_AUTH_RECOVERY.md`](VISUAL_AUTH_RECOVERY.md)
