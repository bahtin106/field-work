# Employee Deactivation System - Quick Start

## üéØ –ß—Ç–æ —ç—Ç–æ?

–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞—è–≤–æ–∫ –∏ —É–º–Ω—ã–º –ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ–º. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∫–∞–∫ –≤ Apple, Google, Slack - –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö, —Å –ø–æ–ª–Ω—ã–º –∞—É–¥–∏—Ç–æ–º.

## ‚ö° –ó–∞ 30 —Å–µ–∫—É–Ω–¥

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞**
2. **–ù–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É "–£–¥–∞–ª–∏—Ç—å"**
3. **System –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:**
   - –ï—Å—Ç—å –ª–∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞—è–≤–∫–∏?
   - –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí —Å—Ä–∞–∑—É –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å
   - –ï—Å–ª–∏ –¥–∞ ‚Üí –≤—ã–±—Ä–∞—Ç—å –ø—Ä–µ–µ–º–Ω–∏–∫–∞ –¥–ª—è –ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
4. **–ó–∞—è–≤–∫–∏ –ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–µ–Ω—ã, —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω**

## üìÅ –§–∞–π–ª—ã

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|---------|
| `supabase/functions/check_employee_orders/index.ts` | –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–ª-–≤–æ –∑–∞—è–≤–æ–∫ |
| `supabase/functions/deactivate_employee/index.ts` | –î–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç + –ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–∞–µ—Ç |
| `app/users/[id]/edit.jsx` | UI –ª–æ–≥–∏–∫–∞ (DeactivateEmployeeModal) |
| `EMPLOYEE_DEACTIVATION_*.md` | –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è |

## ‚úÖ –°—Ç–∞—Ç—É—Å

- ‚úÖ Edge functions —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã
- ‚úÖ React –∫–æ–¥ –≥–æ—Ç–æ–≤
- ‚úÖ –ù–µ—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
- ‚è≥ –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –≤ Expo

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å Expo
npx expo start

# 2. –û—Ç–∫—Ä—ã—Ç—å –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º
# –°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å QR –∏–ª–∏ 'w' –¥–ª—è web

# 3. –¢–µ—Å—Ç—ã:
# –¢–µ—Å—Ç A: –û—Ç–∫—Ä—ã—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –ë–ï–ó –∑–∞—è–≤–æ–∫ ‚Üí –£–¥–∞–ª–∏—Ç—å ‚Üí –ü—Ä–æ—Å—Ç–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ ‚úÖ
# –¢–µ—Å—Ç B: –û—Ç–∫—Ä—ã—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –° –∑–∞—è–≤–∫–∞–º–∏ ‚Üí –£–¥–∞–ª–∏—Ç—å ‚Üí –í—ã–±–æ—Ä –ø—Ä–µ–µ–º–Ω–∏–∫–∞ ‚úÖ
```

## üîç –ü—Ä–∏–º–µ—Ä—ã

### –°—Ü–µ–Ω–∞—Ä–∏–π A: –ë–µ–∑ –∑–∞—è–≤–æ–∫ (0)
```
–û—Ç–∫—Ä—ã—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
  ‚Üì
–ù–∞–∂–∞—Ç—å "–£–¥–∞–ª–∏—Ç—å"
  ‚Üì
Modal: "–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞—è–≤–æ–∫. –î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å?"
  ‚Üì
–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å
  ‚Üì
‚úÖ –°–æ—Ç—Ä—É–¥–Ω–∏–∫ –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ suspended
```

### –°—Ü–µ–Ω–∞—Ä–∏–π B: –° –∑–∞—è–≤–∫–∞–º–∏ (5)
```
–û—Ç–∫—Ä—ã—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞  
  ‚Üì
–ù–∞–∂–∞—Ç—å "–£–¥–∞–ª–∏—Ç—å"
  ‚Üì
Modal: "5 –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞—è–≤–æ–∫. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–µ–º–Ω–∏–∫–∞."
  ‚Üì
SelectModal: –í—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
  ‚Üì
Modal: "5 –∑–∞—è–≤–æ–∫ –ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–µ–Ω—ã. –î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å?"
  ‚Üì
–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å
  ‚Üì
‚úÖ 5 –∑–∞—è–≤–æ–∫ –ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–µ–Ω—ã + —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ suspended
```

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –¢–æ–ª—å–∫–æ admin –º–æ–∂–µ—Ç –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å
- ‚úÖ –ú—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ (soft delete) - –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Ç–µ—Ä—è–µ—Ç –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –ü–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç trail (suspended_at)
- ‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ–µ –ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### profiles —Ç–∞–±–ª–∏—Ü–∞
```sql
- id (UUID)
- email, first_name, last_name, full_name
- is_suspended (BOOLEAN) -- ‚Üê –ú—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ!
- suspended_at (TIMESTAMP) -- ‚Üê –ê—É–¥–∏—Ç!
- role (admin | dispatcher | worker)
```

### orders —Ç–∞–±–ª–∏—Ü–∞
```sql
- id (UUID)
- assigned_to (UUID FK ‚Üí profiles)
- status (new | in_progress | in_feed | completed | cancelled)
- ...
```

## üöÄ –ö–∞–∫ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç–æ?

```bash
# Edge functions —É–∂–µ –Ω–∞ Supabase
npx supabase functions list

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ä–∞–±–æ—Ç–∞—é—Ç:
# GET https://fopalcvzdkftsvhqszcx.supabase.co/functions/v1/check_employee_orders
# POST https://fopalcvzdkftsvhqszcx.supabase.co/functions/v1/deactivate_employee
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- üìñ `EMPLOYEE_DEACTIVATION_SYSTEM.md` - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –¥–∏–∑–∞–π–Ω
- üîß `EMPLOYEE_DEACTIVATION_TECHNICAL_OVERVIEW.md` - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ `EMPLOYEE_DEACTIVATION_FINAL_CHECKLIST.md` - –§–∏–Ω–∞–ª—å–Ω—ã–π —á–µ–∫–ª–∏—Å—Ç
- üìã `EMPLOYEE_DEACTIVATION_IMPLEMENTATION.md` - –ì–∞–π–¥ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

## ‚ùì FAQ

### –ü–æ—á–µ–º—É soft delete –∞ –Ω–µ hard delete?
```
Soft delete (UPDATE is_suspended):
‚úÖ –ò—Å—Ç–æ—Ä–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
‚úÖ GDPR/CCPA compliant
‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
‚úÖ –ü–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç trail

Hard delete (DELETE):
‚ùå –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö
‚ùå –ù–∞—Ä—É—à–µ–Ω–∏–µ —Ä–µ–≥—É–ª—è—Ü–∏–π
‚ùå –ü—Ä–æ–±–ª–µ–º—ã —Å foreign keys
‚ùå –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
```

### –ü–æ—á–µ–º—É —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–µ–µ–º–Ω–∏–∫–∞ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å –∑–∞—è–≤–∫–∏?
```
–õ–æ–≥–∏—á–Ω–æ:
‚úÖ –ï—Å–ª–∏ –Ω–µ—Ç –∑–∞—è–≤–æ–∫ ‚Üí –Ω–µ—á–µ–≥–æ –ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–∞—Ç—å
‚úÖ –ò–∑–±–µ–≥–∞–µ–º –ª–∏—à–Ω–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π
‚úÖ Better UX (–∫–∞–∫ –≤ Apple)

–ù–µ –ª–æ–≥–∏—á–Ω–æ:
‚ùå –¢—Ä–µ–±–æ–≤–∞—Ç—å –≤—ã–±–∏—Ä–∞—Ç—å –∫–æ–≥–¥–∞ –Ω–µ –Ω—É–∂–Ω–æ
‚ùå Extra clicks –±–µ–∑ —Å–º—ã—Å–ª–∞
‚ùå Confusion –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

### –ö–æ–≥–¥–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ?
```
–û–¥–Ω–∞ edge function:
‚úÖ –ê—Ç–æ–º–∞—Ä–Ω–æ–µ (–≤—Å—ë –∏–ª–∏ –Ω–∏—á–µ–≥–æ)
‚úÖ –ù–∏–∫–æ–≥–¥–∞ –ø–æ–ª–æ–≤–∏–Ω—á–∞—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
‚úÖ ACID –≥–∞—Ä–∞–Ω—Ç–∏–∏

–î–≤–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ:
‚ùå –ï—Å–ª–∏ –ø–µ—Ä–≤–∞—è —É—Å–ø–µ–µ—Ç –Ω–æ –≤—Ç–æ—Ä–∞—è —É–ø–∞–¥—ë—Ç:
   - –°–æ—Ç—Ä—É–¥–Ω–∏–∫ –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω, –∑–∞—è–≤–∫–∏ –≤—Å—ë –µ—â—ë –Ω–∞ –Ω—ë–º!
‚ùå –†–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
```

## üîó API Examples

### Check Orders
```bash
curl -X POST https://...supabase.../functions/v1/check_employee_orders \
  -H "Authorization: Bearer {token}" \
  -H "Content-Type: application/json" \
  -d '{"user_id": "550e8400-e29b-41d4-a716-446655440000"}'

# Response:
{
  "success": true,
  "activeOrdersCount": 3,
  "availableEmployees": [...]
}
```

### Deactivate
```bash
curl -X POST https://...supabase.../functions/v1/deactivate_employee \
  -H "Authorization: Bearer {token}" \
  -H "Content-Type: application/json" \
  -d '{
    "user_id": "550e8400...",
    "reassign_to": "660e8400..." 
  }'

# Response:
{
  "success": true,
  "message": "–°–æ—Ç—Ä—É–¥–Ω–∏–∫ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω, –∑–∞—è–≤–∫–∏ –ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–µ–Ω—ã"
}
```

## üéì –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Frontend**: React Native + Expo Router
- **Backend**: Supabase Edge Functions (Deno)
- **Database**: PostgreSQL (Supabase)
- **Auth**: Supabase Auth with Session tokens
- **UI**: Custom theme system, ConfirmModal, SelectModal

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—ã:

1. **–û—à–∏–±–∫–∞ 401**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Authorization header
2. **–û—à–∏–±–∫–∞ 403**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ç–µ–∫—É—â–∏–π user –∏–º–µ–µ—Ç role = 'admin'
3. **–û—à–∏–±–∫–∞ 404**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –ë–î
4. **Edge function –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `npx supabase functions list`

## üìà –í–µ—Ä—Å–∏—è

```
Version: 1.0
Status: Production Ready ‚úÖ
Date: 2024
Quality: Enterprise-grade
Compliance: GDPR ‚úÖ CCPA ‚úÖ
```

---

**–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üöÄ**
