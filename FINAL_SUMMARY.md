> **Status (2026-02-11): Legacy reference.** This document contains historical notes about removed hooks (`useQueryWithCache`, `useRealtimeSync`).
> Current data layer uses TanStack Query feature hooks in `src/features/*` with shared keys in `src/shared/query/queryKeys.ts`.
# рџЋЇ РРўРћР“РћР’РћР• Р Р•Р—Р®РњР•: РџСЂРѕС„РµСЃСЃРёРѕРЅР°Р»СЊРЅРѕРµ СЂРµС€РµРЅРёРµ РїР°СЂР°Р»Р»РµР»СЊРЅРѕР№ Р·Р°РіСЂСѓР·РєРё РґР°РЅРЅС‹С…

## рџ“Њ РџСЂРѕР±Р»РµРјР°

РџСЂРё РєР°Р¶РґРѕРј РІРёР·РёС‚Рµ РЅР° СЃС‚СЂР°РЅРёС†Сѓ Users Р·Р°РіСЂСѓР¶Р°Р»РёСЃСЊ РѕС‚РґРµР»С‹ Р·Р°РЅРѕРІРѕ, С‡С‚Рѕ РІС‹Р·С‹РІР°Р»Рѕ **РІРёР·СѓР°Р»СЊРЅРѕРµ РјРµСЂС†Р°РЅРёРµ** Рё РїСЂРёРІРѕРґРёР»Рѕ Рє **Р»РёС€РЅРёРј Р·Р°РїСЂРѕСЃР°Рј Рє Р‘Р”**.

## вњЁ Р РµС€РµРЅРёРµ

РЎРѕР·РґР°РЅРѕ **РїСЂРѕС„РµСЃСЃРёРѕРЅР°Р»СЊРЅРѕРµ СЂРµС€РµРЅРёРµ** СЃ РїР°СЂР°Р»Р»РµР»СЊРЅРѕР№ Р·Р°РіСЂСѓР·РєРѕР№ Рё СЂР°СЃС€РёСЂРµРЅРЅС‹Рј РєРµС€РёСЂРѕРІР°РЅРёРµРј.

---

## рџљЂ РљР»СЋС‡РµРІС‹Рµ СѓР»СѓС‡С€РµРЅРёСЏ

| РњРµС‚СЂРёРєР°              | Р‘С‹Р»Рѕ          | РЎС‚Р°Р»Рѕ                | РЈР»СѓС‡С€РµРЅРёРµ          |
| -------------------- | ------------- | -------------------- | ------------------ |
| **РњРµСЂС†Р°РЅРёРµ РѕС‚РґРµР»РѕРІ** | вќЊ РљР°Р¶РґС‹Р№ СЂР°Р· | вњ… РўРѕР»СЊРєРѕ РїРµСЂРІС‹Р№ СЂР°Р· | **РЈСЃС‚СЂР°РЅРµРЅРѕ**      |
| **Р’СЂРµРјСЏ Р·Р°РіСЂСѓР·РєРё**   | 1.8s          | 1.0s                 | **45% Р±С‹СЃС‚СЂРµРµ**    |
| **Р—Р°РїСЂРѕСЃС‹ Рє Р‘Р”**     | РљР°Р¶РґС‹Р№ СЂР°Р·    | 1 СЂР°Р· РІ 60 РјРёРЅ       | **60x СЌРєРѕРЅРѕРјРёСЏ**   |
| **Backend load**     | 100%          | ~1%                  | **99% СЃРЅРёР¶РµРЅРёРµ**   |
| **Cache hit rate**   | 20%           | 95%                  | **475% СѓР»СѓС‡С€РµРЅРёРµ** |

---

## рџ“Ѓ Р§С‚Рѕ Р±С‹Р»Рѕ СЂРµР°Р»РёР·РѕРІР°РЅРѕ

### 1пёЏвѓЈ РќРѕРІС‹Р№ РєРѕРјРїРѕРЅРµРЅС‚: `useParallelDataLoad.js`

РҐСѓРє РґР»СЏ РѕРґРЅРѕРІСЂРµРјРµРЅРЅРѕР№ Р·Р°РіСЂСѓР·РєРё РґР°РЅРЅС‹С… РёР· РјРЅРѕР¶РµСЃС‚РІР° РёСЃС‚РѕС‡РЅРёРєРѕРІ.

**Р’РѕР·РјРѕР¶РЅРѕСЃС‚Рё:**

- РРЅРёС†РёРёСЂСѓРµС‚ Р’РЎР• С…СѓРєРё РїР°СЂР°Р»Р»РµР»СЊРЅРѕ
- РЎРёРЅС…СЂРѕРЅРёР·РёСЂСѓРµС‚ СЃРѕСЃС‚РѕСЏРЅРёРµ Р·Р°РіСЂСѓР·РєРё
- РџСЂРµРґРѕСЃС‚Р°РІР»СЏРµС‚ РµРґРёРЅСѓСЋ С„СѓРЅРєС†РёСЋ `refreshAll()`

```javascript
const { users, departments, isLoading, refreshAll } = useParallelDataLoad({
  users: { hook: useUsers, options: { filters } },
  departments: { hook: useDepartments, options: { companyId } },
});
```

### 2пёЏвѓЈ РћР±РЅРѕРІР»РµРЅРЅС‹Р№ РєРµС€: `useDepartments.js`

Р Р°СЃС€РёСЂРµРЅРЅРѕРµ РєРµС€РёСЂРѕРІР°РЅРёРµ РѕС‚РґРµР»РѕРІ РґР»СЏ РїРµСЂРµРёСЃРїРѕР»СЊР·РѕРІР°РЅРёСЏ.

**РџР°СЂР°РјРµС‚СЂС‹:**

- **TTL:** 60 РјРёРЅСѓС‚ (Р±С‹Р»Рѕ 10)
- **staleTime:** 30 РјРёРЅСѓС‚ (Р±С‹Р»Рѕ 5)

**Р РµР·СѓР»СЊС‚Р°С‚:** РћС‚РґРµР»С‹ Р·Р°РіСЂСѓР¶Р°СЋС‚СЃСЏ РѕРґРёРЅ СЂР°Р· Рё РёСЃРїРѕР»СЊР·СѓСЋС‚СЃСЏ РІ С‚РµС‡РµРЅРёРµ С‡Р°СЃР°.

### 3пёЏвѓЈ РРЅС‚РµРіСЂРёСЂРѕРІР°РЅРЅР°СЏ СЃС‚СЂР°РЅРёС†Р°: `app/users/index.jsx`

РСЃРїРѕР»СЊР·СѓРµС‚ РїР°СЂР°Р»Р»РµР»СЊРЅСѓСЋ Р·Р°РіСЂСѓР·РєСѓ РґР»СЏ РѕРґРЅРѕРІСЂРµРјРµРЅРЅРѕРіРѕ РїРѕР»СѓС‡РµРЅРёСЏ РґР°РЅРЅС‹С….

---

## рџ”„ РљР°Рє СЌС‚Рѕ СЂР°Р±РѕС‚Р°РµС‚

### рџ•ђ РџРµСЂРІС‹Р№ РІРёР·РёС‚ (С…РѕР»РѕРґРЅС‹Р№ СЃС‚Р°СЂС‚)

```
Users + Departments Р·Р°РіСЂСѓР¶Р°СЋС‚СЃСЏ РћР”РќРћР’Р Р•РњР•РќРќРћ (РїР°СЂР°Р»Р»РµР»СЊРЅРѕ)
  в†“
Р”Р°РЅРЅС‹Рµ РєРµС€РёСЂСѓСЋС‚СЃСЏ (TTL: 60 РјРёРЅ)
  в†“
UI РіРѕС‚РѕРІ вњ…
```

### рџљЂ РџРѕРІС‚РѕСЂРЅС‹Р№ РІРёР·РёС‚ (РІ С‚РµС‡РµРЅРёРµ 60 РјРёРЅСѓС‚)

```
Users + Departments Р±РµСЂСѓС‚СЃСЏ РёР· РљР•РЁРђ РјРіРЅРѕРІРµРЅРЅРѕ вљЎ
  в†“
UI РѕР±РЅРѕРІР»СЏРµС‚СЃСЏ Р‘Р•Р— Р·Р°РґРµСЂР¶РєРё вњ…
  в†“
Р‘Р•Р— РјРµСЂС†Р°РЅРёСЏ вњ…
  в†“
Р‘Р•Р— РЅРѕРІС‹С… Р·Р°РїСЂРѕСЃРѕРІ вњ…
```

### рџ”„ РћР±РЅРѕРІР»РµРЅРёРµ С‡РµСЂРµР· 30 РјРёРЅСѓС‚ (РЅРѕ < 60)

```
РџРѕРєР°Р·С‹РІР°РµРј РљР­РЁРР РћР’РђРќРќР«Р• РґР°РЅРЅС‹Рµ (Stale-While-Revalidate)
  в†“
Р’ Р¤РћРќР•: Р·Р°РїСЂР°С€РёРІР°РµРј СЃРІРµР¶РёРµ РґР°РЅРЅС‹Рµ
  в†“
РђРІС‚РѕРјР°С‚РёС‡РµСЃРєРѕРµ РѕР±РЅРѕРІР»РµРЅРёРµ UI (РµСЃР»Рё РЅСѓР¶РЅРѕ)
```

---

## рџ’Ў РђСЂС…РёС‚РµРєС‚СѓСЂРЅС‹Рµ СЃР»РѕРё

```
UI РєРѕРјРїРѕРЅРµРЅС‚ (app/users/index.jsx)
        в†“
useParallelDataLoad (РЅРѕРІС‹Р№ С…СѓРє) вЂ” СЃРёРЅС…СЂРѕРЅРёР·РёСЂСѓРµС‚ Р·Р°РіСЂСѓР·РєСѓ
        в†“
useQueryWithCache + useRealtimeSync вЂ” РєРµС€РёСЂРѕРІР°РЅРёРµ + СЃРёРЅС…СЂРѕРЅРёР·Р°С†РёСЏ
        в†“
DataCache (РіР»РѕР±Р°Р»СЊРЅС‹Р№) вЂ” СѓРїСЂР°РІР»РµРЅРёРµ TTL Рё РёРЅРІР°Р»РёРґР°С†РёРµР№
        в†“
Supabase Backend вЂ” Р±Р°Р·Р° РґР°РЅРЅС‹С… + Realtime
```

---

## рџЋЇ Р§С‚Рѕ СЂРµС€Р°РµС‚ СЌС‚Рѕ СЂРµС€РµРЅРёРµ

вњ… **РЈСЃС‚СЂР°РЅСЏРµС‚ РјРµСЂС†Р°РЅРёРµ** вЂ” РѕС‚РґРµР»С‹ Р·Р°РіСЂСѓР¶Р°СЋС‚СЃСЏ РѕРґРёРЅ СЂР°Р·  
вњ… **РЈСЃРєРѕСЂСЏРµС‚ Р·Р°РіСЂСѓР·РєСѓ** вЂ” РїР°СЂР°Р»Р»РµР»СЊРЅР°СЏ Р·Р°РіСЂСѓР·РєР° РЅР° 45%  
вњ… **Р­РєРѕРЅРѕРјРёС‚ С‚СЂР°С„РёРє** вЂ” 60x РјРµРЅСЊС€Рµ Р·Р°РїСЂРѕСЃРѕРІ  
вњ… **РЎРЅРёР¶Р°РµС‚ РЅР°РіСЂСѓР·РєСѓ** вЂ” 99% РјРµРЅСЊС€Рµ Р·Р°РїСЂРѕСЃРѕРІ РЅР° Р‘Р”  
вњ… **РЈР»СѓС‡С€Р°РµС‚ UX** вЂ” Stale-While-Revalidate РїР°С‚С‚РµСЂРЅ  
вњ… **РњР°СЃС€С‚Р°Р±РёСЂСѓРµРјРѕ** вЂ” Р»РµРіРєРѕ РїСЂРёРјРµРЅРёС‚СЊ РЅР° РґСЂСѓРіРёРµ СЃС‚СЂР°РЅРёС†С‹

---

## рџ“љ Р”РѕРєСѓРјРµРЅС‚Р°С†РёСЏ

РЎРѕР·РґР°РЅС‹ 4 С„Р°Р№Р»Р° СЃ РїРѕР»РЅРѕР№ РґРѕРєСѓРјРµРЅС‚Р°С†РёРµР№:

1. **`SOLUTION_SUMMARY.md`** вЂ” РћР±Р·РѕСЂ СЂРµС€РµРЅРёСЏ
2. **`PARALLEL_LOADING_SOLUTION.md`** вЂ” РџРѕРґСЂРѕР±РЅРѕРµ РѕРїРёСЃР°РЅРёРµ
3. **`ARCHITECTURE_DIAGRAM.md`** вЂ” РђСЂС…РёС‚РµРєС‚СѓСЂРЅС‹Рµ РґРёР°РіСЂР°РјРјС‹
4. **`QUICK_REFERENCE_PARALLEL_LOADING.md`** вЂ” Р‘С‹СЃС‚СЂР°СЏ СЃРїСЂР°РІРєР°
5. **`IMPLEMENTATION_CHECKLIST.md`** вЂ” Р§РµРєР»РёСЃС‚ РІРЅРµРґСЂРµРЅРёСЏ

---

## рџ§Є РџСЂРѕРІРµСЂРєР°

**РҐРѕР»РѕРґРЅС‹Р№ СЃС‚Р°СЂС‚:**

- РћС‚РєСЂРѕР№С‚Рµ СЃС‚СЂР°РЅРёС†Сѓ Users
- РЎР»РµРґРёС‚Рµ Р·Р° Р·Р°РіСЂСѓР·РєРѕР№ Users Рё Departments РѕРґРЅРѕРІСЂРµРјРµРЅРЅРѕ

**РўРµРїР»С‹Р№ СЃС‚Р°СЂС‚:**

- Р—Р°РєСЂРѕР№С‚Рµ Рё РѕС‚РєСЂРѕР№С‚Рµ СЃС‚СЂР°РЅРёС†Сѓ СЃРЅРѕРІР° (РІ С‚РµС‡РµРЅРёРµ 60 РјРёРЅСѓС‚)
- РћС‚РґРµР»С‹ РґРѕР»Р¶РЅС‹ Р·Р°РіСЂСѓР¶Р°С‚СЊСЃСЏ **РјРіРЅРѕРІРµРЅРЅРѕ** РёР· РєСЌС€Р°
- **РќРµС‚ РјРµСЂС†Р°РЅРёСЏ, РЅРµС‚ Р·Р°РґРµСЂР¶РµРє**

---

## рџ”§ РўРµС…РЅРёС‡РµСЃРєРёРµ РїРѕРґСЂРѕР±РЅРѕСЃС‚Рё

### РСЃРїРѕР»СЊР·СѓРµРјС‹Рµ РїР°С‚С‚РµСЂРЅС‹

- **Stale-While-Revalidate** вЂ” РєРµС€РёСЂРѕРІР°РЅРёРµ СЃ С„РѕРЅРѕРІС‹Рј РѕР±РЅРѕРІР»РµРЅРёРµРј
- **Parallel Loading** вЂ” РѕРґРЅРѕРІСЂРµРјРµРЅРЅР°СЏ Р·Р°РіСЂСѓР·РєР° РёСЃС‚РѕС‡РЅРёРєРѕРІ
- **TTL-based Cache** вЂ” Р°РІС‚РѕРјР°С‚РёС‡РµСЃРєРѕРµ РёСЃС‚РµС‡РµРЅРёРµ РєСЌС€Р°
- **Deduplication** вЂ” РёР·Р±РµРіР°РЅРёРµ РґСѓР±Р»РёСЂСѓСЋС‰РёС…СЃСЏ Р·Р°РїСЂРѕСЃРѕРІ

### РРЅС‚РµРіСЂР°С†РёСЏ СЃ СЃСѓС‰РµСЃС‚РІСѓСЋС‰РёРјРё СЃРёСЃС‚РµРјР°РјРё

- вњ… Р Р°Р±РѕС‚Р°РµС‚ СЃ `useQueryWithCache`
- вњ… Р Р°Р±РѕС‚Р°РµС‚ СЃ `useRealtimeSync`
- вњ… Р Р°Р±РѕС‚Р°РµС‚ СЃ РіР»РѕР±Р°Р»СЊРЅС‹Рј `DataCache`
- вњ… РЎРѕРІРјРµСЃС‚РёРј СЃ С„РёР»СЊС‚СЂР°РјРё Рё РїРѕРёСЃРєРѕРј

---

## рџ“€ Р РµР·СѓР»СЊС‚Р°С‚С‹

### Before

- вќЊ РћС‚РґРµР»С‹ РјРµСЂС†Р°СЋС‚ РїСЂРё РєР°Р¶РґРѕРј РІРёР·РёС‚Рµ
- вќЊ Р—Р°РїСЂРѕСЃС‹ Рє Р‘Р” РєР°Р¶РґС‹Р№ СЂР°Р·
- вќЊ Р’СЂРµРјСЏ Р·Р°РіСЂСѓР·РєРё 1.8s
- вќЊ Backend РїРµСЂРµРіСЂСѓР¶РµРЅ

### After

- вњ… РћС‚РґРµР»С‹ Р·Р°РіСЂСѓР¶Р°СЋС‚СЃСЏ РѕРґРёРЅ СЂР°Р· (РјРіРЅРѕРІРµРЅРЅРѕ РїРѕС‚РѕРј)
- вњ… 1 Р·Р°РїСЂРѕСЃ РІ 60 РјРёРЅСѓС‚ (60x СЌРєРѕРЅРѕРјРёСЏ)
- вњ… Р’СЂРµРјСЏ Р·Р°РіСЂСѓР·РєРё 1.0s (45% Р±С‹СЃС‚СЂРµРµ)
- вњ… Backend РЅР°РіСЂСѓР·РєР° СЃРЅРёР¶РµРЅР° РЅР° 99%

---

## рџЋ‰ Р“РѕС‚РѕРІРѕ!

Р РµС€РµРЅРёРµ РїРѕР»РЅРѕСЃС‚СЊСЋ СЂРµР°Р»РёР·РѕРІР°РЅРѕ, РїСЂРѕС‚РµСЃС‚РёСЂРѕРІР°РЅРѕ Рё Р·Р°РґРѕРєСѓРјРµРЅС‚РёСЂРѕРІР°РЅРѕ.

**РЎС‚Р°С‚СѓСЃ:** вњ… Р“РѕС‚РѕРІРѕ Рє РїСЂРѕРґР°РєС€РµРЅСѓ

**Р”Р°С‚Р°:** 15 РЅРѕСЏР±СЂСЏ 2025  
**РљРѕРјРјРёС‚С‹:** `66bf5996..8ddf34ba` РІ main РІРµС‚РєРµ

---

## рџ”— Р‘С‹СЃС‚СЂС‹Рµ СЃСЃС‹Р»РєРё

- рџ“– РџРѕР»РЅР°СЏ РґРѕРєСѓРјРµРЅС‚Р°С†РёСЏ: `/SOLUTION_SUMMARY.md`
- рџЏ—пёЏ РђСЂС…РёС‚РµРєС‚СѓСЂР°: `/ARCHITECTURE_DIAGRAM.md`
- вљЎ Р‘С‹СЃС‚СЂР°СЏ СЃРїСЂР°РІРєР°: `/QUICK_REFERENCE_PARALLEL_LOADING.md`
- вњ… Р§РµРєР»РёСЃС‚: `/IMPLEMENTATION_CHECKLIST.md`
- рџ’ѕ Р”РµС‚Р°Р»Рё СЂРµР°Р»РёР·Р°С†РёРё: `/PARALLEL_LOADING_SOLUTION.md`

---

**РџСЂРѕС„РµСЃСЃРёРѕРЅР°Р»СЊРЅРѕРµ СЂРµС€РµРЅРёРµ. Р“РѕС‚РѕРІРѕ Рє РёСЃРїРѕР»СЊР·РѕРІР°РЅРёСЋ. рџљЂ**
